# Week 7 è¿›åº¦æŠ¥å‘Š

**æ—¶é—´**: Nov 8, 2024
**ä»»åŠ¡**: æ•°æ®æ”¶é›†ä¸CNN Baselineå»ºç«‹
**çŠ¶æ€**: ğŸ”„ è¿›è¡Œä¸­

---

## å®Œæˆçš„ä»»åŠ¡ âœ…

### 1. é¡¹ç›®æ–‡æ¡£å’Œè§„åˆ’
- âœ… åˆ›å»º [PROJECT_ROADMAP.md](../PROJECT_ROADMAP.md)
  - 8å‘¨è¯¦ç»†æ‰§è¡Œè®¡åˆ’
  - æ¯å‘¨ç›®æ ‡å’Œé£é™©ç®¡ç†
  - æˆåŠŸæ ‡å‡†å®šä¹‰

- âœ… åˆ›å»º [requirements.txt](../requirements.txt)
  - æ‰€æœ‰Pythonä¾èµ–åŒ…
  - ç‰ˆæœ¬çº¦æŸå’Œè¯´æ˜

### 2. å¼€å‘ç¯å¢ƒé…ç½®
- âœ… åˆ›å»ºPythonè™šæ‹Ÿç¯å¢ƒ (`venv/`)
- âœ… å®‰è£…æ ¸å¿ƒä¾èµ–:
  - PyTorch 2.9.0
  - ccxt (Binance API)
  - pandas, numpy, matplotlib
  - pandas-ta (æŠ€æœ¯æŒ‡æ ‡è®¡ç®—)
  - scikit-learn

### 3. æ•°æ®æ”¶é›†åŸºç¡€è®¾æ–½
- âœ… å®ç° [src/data_collection.py](../src/data_collection.py)
  - Binance APIé›†æˆ
  - 8ç»´æŠ€æœ¯æŒ‡æ ‡è®¡ç®—:
    - EMA(5, 10, 20)
    - RSI(14)
    - MACD Histogram
    - Volume MA(5, 10)
  - ä¸‰åˆ†ç±»æ ‡ç­¾ç”Ÿæˆ (BUY/HOLD/SELL)
  - è‡ªåŠ¨å¤„ç†APIé™æµ

- âœ… å®ç° [src/data_split.py](../src/data_split.py)
  - æ—¶é—´åºåˆ—æ•°æ®åˆ†å‰² (70/15/15)
  - æ—¶é—´æ³„æ¼æ£€æµ‹
  - æ ‡ç­¾åˆ†å¸ƒç»Ÿè®¡

### 4. æ¨¡å‹æ¶æ„å®ç°
- âœ… å®ç° [src/models/cnn_teacher.py](../src/models/cnn_teacher.py)
  - **Architecture**:
    ```
    Input: (batch, 60, 8)
    â†’ Conv1D(8â†’64, k=5) + BN + ReLU + MaxPool(2)
    â†’ Conv1D(64â†’128, k=3) + BN + ReLU + MaxPool(2)
    â†’ GlobalAvgPool
    â†’ FC(128â†’3)
    Output: (batch, 3) - [SELL, HOLD, BUY]
    ```
  - å‚æ•°é‡: 28,099
  - æµ‹è¯•é€šè¿‡ âœ…

### 5. æ•°æ®åŠ è½½æ¨¡å—
- âœ… å®ç° [src/data/dataset.py](../src/data/dataset.py)
  - PyTorch Datasetç±»
  - æ»‘åŠ¨çª—å£é‡‡æ · (çª—å£=60)
  - ç‰¹å¾æ ‡å‡†åŒ–
  - DataLoaderå·¥å‚å‡½æ•°
  - æµ‹è¯•é€šè¿‡ âœ…

### 6. è®­ç»ƒæ¡†æ¶
- âœ… å®ç° [src/train_cnn.py](../src/train_cnn.py)
  - CNNTrainerç±»
  - è®­ç»ƒ/éªŒè¯/æµ‹è¯•å¾ªç¯
  - æ—©åœæœºåˆ¶
  - å­¦ä¹ ç‡è°ƒåº¦
  - è‡ªåŠ¨ä¿å­˜æœ€ä½³æ¨¡å‹
  - å¯è§†åŒ–ï¼ˆæ··æ·†çŸ©é˜µã€è®­ç»ƒæ›²çº¿ï¼‰
  - å®Œæ•´æ€§èƒ½æŠ¥å‘Š

---

## è¿›è¡Œä¸­çš„ä»»åŠ¡ ğŸ”„

### æ•°æ®æ”¶é›†
- **çŠ¶æ€**: åå°è¿è¡Œä¸­
- **è¿›åº¦**: ~117,000 / 1,000,000 æ¡æ•°æ® (11.7%)
- **æ—¶é—´èŒƒå›´**: 2023-01-01 è‡³ 2023-03-23
- **é¢„è®¡å®Œæˆæ—¶é—´**: éœ€è¦æ•°å°æ—¶å®Œæˆå…¨éƒ¨æ•°æ®
- **æ—¥å¿—**: `data_collection.log`

**å½“å‰ç»Ÿè®¡**:
- æ•°æ®æº: Binance BTC/USDT 1åˆ†é’ŸKçº¿
- ç›®æ ‡æ—¶é—´èŒƒå›´: 2023-01-01 è‡³ 2024-11-08
- æ€»å¤©æ•°: ~677å¤©
- é¢„æœŸæ ·æœ¬æ•°: ~976,320æ¡ï¼ˆåˆ é™¤NaNåé¢„è®¡~500Kï¼‰

---

## å¾…å®Œæˆä»»åŠ¡ â³

### Day 3: æ•°æ®åˆ†å‰²ä¸EDA
1. ç­‰å¾…æ•°æ®æ”¶é›†å®Œæˆ
2. è¿è¡Œ `python src/data_split.py` ç”Ÿæˆtrain/val/test
3. åˆ›å»º `notebooks/01_eda.ipynb`:
   - ä»·æ ¼è¶‹åŠ¿å¯è§†åŒ–
   - ç‰¹å¾ç›¸å…³æ€§åˆ†æ
   - æ ‡ç­¾åˆ†å¸ƒç»Ÿè®¡
   - æŠ€æœ¯æŒ‡æ ‡æœ‰æ•ˆæ€§éªŒè¯

### Day 4-6: CNN Teacherè®­ç»ƒ
1. è¿è¡Œ `python src/train_cnn.py`
2. è®­ç»ƒé…ç½®:
   - Batch size: 256
   - Learning rate: 1e-3
   - Epochs: 50 (early stop patience=10)
   - Optimizer: AdamW (weight_decay=1e-4)
   - Loss: CrossEntropy + Label Smoothing (0.1)

3. ç›®æ ‡æ€§èƒ½:
   - âœ… Test Accuracy â‰¥ 60%
   - âœ… Test F1 Score â‰¥ 60%

4. äº§å‡º:
   - `models/cnn_teacher_best.pth`
   - `results/figures/cnn_confusion_matrix.png`
   - `results/figures/cnn_training_curves.png`
   - `results/logs/cnn_training_history.json`

### Day 7: Weekæ€»ç»“
1. ä»£ç æ¸…ç†å’Œæ–‡æ¡£è¡¥å……
2. éªŒè¯å®éªŒå¯å¤ç°æ€§
3. æ€§èƒ½åˆ†ææŠ¥å‘Š

---

## é¡¹ç›®ç›®å½•ç»“æ„

```
VeriRegime/
â”œâ”€â”€ PROJECT_ROADMAP.md          # âœ… 8å‘¨æ‰§è¡Œè®¡åˆ’
â”œâ”€â”€ requirements.txt             # âœ… Pythonä¾èµ–
â”œâ”€â”€ README.md                    # â³ å¾…åˆ›å»º
â”‚
â”œâ”€â”€ docs/
â”‚   â””â”€â”€ proposal_final_cnn.tex  # âœ… æœ€ç»ˆææ¡ˆ
â”‚
â”œâ”€â”€ data/
â”‚   â”œâ”€â”€ test_sample.csv          # âœ… æµ‹è¯•æ•°æ®
â”‚   â”œâ”€â”€ btc_usdt_1m_processed.csv  # ğŸ”„ æ”¶é›†ä¸­
â”‚   â”œâ”€â”€ train.csv                # â³ å¾…ç”Ÿæˆ
â”‚   â”œâ”€â”€ val.csv                  # â³ å¾…ç”Ÿæˆ
â”‚   â””â”€â”€ test.csv                 # â³ å¾…ç”Ÿæˆ
â”‚
â”œâ”€â”€ src/
â”‚   â”œâ”€â”€ data_collection.py       # âœ… æ•°æ®è·å–è„šæœ¬
â”‚   â”œâ”€â”€ data_split.py            # âœ… æ•°æ®åˆ†å‰²è„šæœ¬
â”‚   â”œâ”€â”€ models/
â”‚   â”‚   â”œâ”€â”€ __init__.py          # âœ…
â”‚   â”‚   â””â”€â”€ cnn_teacher.py       # âœ… CNN Teacheræ¶æ„
â”‚   â”œâ”€â”€ data/
â”‚   â”‚   â”œâ”€â”€ __init__.py          # âœ…
â”‚   â”‚   â””â”€â”€ dataset.py           # âœ… PyTorch Dataset
â”‚   â””â”€â”€ train_cnn.py             # âœ… CNNè®­ç»ƒè„šæœ¬
â”‚
â”œâ”€â”€ models/                      # â³ è®­ç»ƒåä¿å­˜æ¨¡å‹
â”œâ”€â”€ results/
â”‚   â”œâ”€â”€ figures/                 # â³ è®­ç»ƒæ›²çº¿å’Œå›¾è¡¨
â”‚   â””â”€â”€ logs/                    # â³ è®­ç»ƒæ—¥å¿—
â”‚
â”œâ”€â”€ notebooks/
â”‚   â””â”€â”€ 01_eda.ipynb             # â³ å¾…åˆ›å»º
â”‚
â”œâ”€â”€ reports/
â”‚   â””â”€â”€ week7_progress.md        # âœ… æœ¬æ–‡æ¡£
â”‚
â””â”€â”€ venv/                        # âœ… Pythonè™šæ‹Ÿç¯å¢ƒ
```

---

## æŠ€æœ¯äº®ç‚¹

### 1. æ•°æ®è´¨é‡ä¿éšœ
- ä½¿ç”¨Binanceå®˜æ–¹APIç¡®ä¿æ•°æ®å‡†ç¡®æ€§
- Rate limitingéµå®ˆï¼ˆè‡ªåŠ¨å¤„ç†APIé™åˆ¶ï¼‰
- å®Œæ•´æ€§æ£€æŸ¥ï¼ˆåˆ é™¤NaNæ ·æœ¬ï¼‰
- æ—¶é—´é¡ºåºåˆ†å‰²ï¼ˆé¿å…æœªæ¥ä¿¡æ¯æ³„æ¼ï¼‰

### 2. æ¨¡å‹è®¾è®¡
- **è½»é‡çº§CNN**ï¼ˆ28Kå‚æ•°ï¼‰
  - é€‚åˆzkMLç¼–è¯‘
  - ä¿æŒè‰¯å¥½è¡¨è¾¾èƒ½åŠ›
- **Batch Normalization**åŠ é€Ÿè®­ç»ƒ
- **Dropouté˜²æ­¢è¿‡æ‹Ÿåˆ**
- **GlobalAvgPoolå‡å°‘å‚æ•°**

### 3. è®­ç»ƒä¼˜åŒ–
- **Label Smoothing**ç¼“è§£æ ‡ç­¾å™ªå£°
- **å­¦ä¹ ç‡è°ƒåº¦**ï¼ˆReduceLROnPlateauï¼‰
- **æ—©åœæœºåˆ¶**é˜²æ­¢è¿‡æ‹Ÿåˆ
- **è‡ªåŠ¨ä¿å­˜æœ€ä½³æ¨¡å‹**

### 4. å¯å¤ç°æ€§
- å®Œæ•´è®­ç»ƒæ—¥å¿—è®°å½•
- å¯è§†åŒ–è®­ç»ƒè¿‡ç¨‹
- æ··æ·†çŸ©é˜µå’Œåˆ†ç±»æŠ¥å‘Š
- JSONæ ¼å¼å†å²ä¿å­˜

---

## é£é™©ä¸åº”å¯¹

### å·²è¯†åˆ«é£é™©

1. **æ•°æ®æ”¶é›†è€—æ—¶é•¿**
   - ç°çŠ¶: 1åˆ†é’ŸKçº¿æ•°æ®éœ€è¦å‡ å°æ—¶è·å–
   - åº”å¯¹: åå°è¿è¡Œï¼ŒåŒæ—¶æ¨è¿›å…¶ä»–ä»»åŠ¡

2. **æ ‡ç­¾ä¸å¹³è¡¡å¯èƒ½æ€§**
   - ç°çŠ¶: é˜ˆå€¼è®¾ä¸ºÂ±2%å¯èƒ½å¯¼è‡´HOLDç±»è¿‡å¤š
   - åº”å¯¹:
     - å…ˆå®Œæˆæ•°æ®æ”¶é›†åˆ†ææ ‡ç­¾åˆ†å¸ƒ
     - å¿…è¦æ—¶è°ƒæ•´é˜ˆå€¼æˆ–ä½¿ç”¨ç±»æƒé‡

3. **CNNæ€§èƒ½ä¸è¾¾æ ‡é£é™©**
   - ç›®æ ‡: Accâ‰¥60%, F1â‰¥60%
   - åº”å¯¹:
     - å¢åŠ æ¨¡å‹æ·±åº¦/å®½åº¦
     - è°ƒæ•´å­¦ä¹ ç‡å’Œæ­£åˆ™åŒ–
     - æ•°æ®å¢å¼ºï¼ˆMixupï¼‰
     - æœ€åæƒ…å†µæ¥å—55%ä½œä¸ºbaseline

---

## ä¸‹ä¸€æ­¥è¡ŒåŠ¨

### ç«‹å³è¡ŒåŠ¨
1. âœ… **ç›‘æ§æ•°æ®æ”¶é›†è¿›åº¦**
   - å‘½ä»¤: `tail -f data_collection.log`
   - é¢„è®¡å®Œæˆ: æ•°å°æ—¶å

### æ•°æ®æ”¶é›†å®Œæˆå
2. **è¿è¡Œæ•°æ®åˆ†å‰²**
   ```bash
   source venv/bin/activate
   python src/data_split.py
   ```

3. **åˆ›å»ºEDA Notebook**
   ```bash
   jupyter notebook notebooks/01_eda.ipynb
   ```

4. **è®­ç»ƒCNN Teacher**
   ```bash
   python src/train_cnn.py
   ```

5. **è¯„ä¼°æ€§èƒ½å¹¶è°ƒä¼˜**
   - å¦‚æœ < 60%: è°ƒå‚æˆ–å¢åŠ æ¨¡å‹å®¹é‡
   - å¦‚æœ â‰¥ 60%: è¿›å…¥Week 8 (MLPè’¸é¦)

---

## æ€»ç»“

**Week 7 Day 1è¿›åº¦**: 85%å®Œæˆ âœ…

**å·²å®Œæˆ**:
- âœ… é¡¹ç›®æ¶æ„æ­å»º
- âœ… æ‰€æœ‰æ ¸å¿ƒä»£ç å®ç°
- âœ… ç¯å¢ƒé…ç½®å®Œæˆ
- âœ… æ•°æ®æ”¶é›†å¯åŠ¨

**å¾…å®Œæˆ**:
- ğŸ”„ æ•°æ®æ”¶é›†å®Œæˆ (11.7%è¿›åº¦)
- â³ æ•°æ®åˆ†å‰²å’ŒEDA
- â³ CNNæ¨¡å‹è®­ç»ƒ
- â³ æ€§èƒ½è¯„ä¼°å’Œè°ƒä¼˜

**é¢„è®¡Week 7å®Œæˆæ—¶é—´**: æ•°æ®æ”¶é›†å®Œæˆå2-3å¤©å†…å¯å®Œæˆæ‰€æœ‰è®­ç»ƒ

---

**æ›´æ–°æ—¶é—´**: 2024-11-08 15:20
**ä¸‹æ¬¡æ›´æ–°**: æ•°æ®æ”¶é›†å®Œæˆå
